[gd_scene load_steps=20 format=3 uid="uid://bj8apjhrx18wt"]

[ext_resource type="Texture2D" uid="uid://clkagh5p3u7ae" path="res://assets/MC/crouching/MC_C-1.png" id="1_y2jd1"]
[ext_resource type="Texture2D" uid="uid://lkysukq8armn" path="res://assets/MC/crouching/MC_C-2.png" id="2_ujgvs"]
[ext_resource type="Texture2D" uid="uid://b87pewbwi5pqh" path="res://assets/MC/crouching/MC_C-3.png" id="3_mf6a4"]
[ext_resource type="Texture2D" uid="uid://360y1d7gwsg1" path="res://assets/MC/crouching/MC_C-4.png" id="4_ia4ch"]
[ext_resource type="Texture2D" uid="uid://du8ivbloua1vf" path="res://assets/MC/running/MC_R-1.png" id="5_ysutu"]
[ext_resource type="Texture2D" uid="uid://brq8kusysb3ru" path="res://assets/MC/running/MC_R-2.png" id="6_yyu65"]
[ext_resource type="Texture2D" uid="uid://pjcejyblmg6f" path="res://assets/MC/running/MC_R-3.png" id="7_pi856"]
[ext_resource type="Texture2D" uid="uid://dnq4rmq4etaev" path="res://assets/MC/running/MC_R-4.png" id="8_jbhoh"]
[ext_resource type="Texture2D" uid="uid://bnrxienmcatf" path="res://assets/MC/walking/MC_W-1.png" id="9_rav1o"]
[ext_resource type="Texture2D" uid="uid://xxw73kui7r0f" path="res://assets/MC/walking/MC_W-2.png" id="10_7nqqg"]
[ext_resource type="Texture2D" uid="uid://cujvtdvx5kv1b" path="res://assets/MC/walking/MC_W-3.png" id="11_mwboh"]
[ext_resource type="Texture2D" uid="uid://ddjki0o88b3tv" path="res://assets/MC/walking/MC_W-4.png" id="12_rtvn4"]
[ext_resource type="Texture2D" uid="uid://cm7rxadu48l26" path="res://assets/MC/walking/MC_W-5.png" id="13_bql0y"]
[ext_resource type="Texture2D" uid="uid://cmtd6mce37kg6" path="res://assets/MC/walking/MC_W-6.png" id="14_lb3sg"]
[ext_resource type="Texture2D" uid="uid://bcq4h8xvnrdf6" path="res://assets/MC/walking/MC_W-7.png" id="15_wwkyk"]
[ext_resource type="Texture2D" uid="uid://dr2f1t7bx0oi8" path="res://assets/MC/walking/MC_W-8.png" id="16_6txg6"]

[sub_resource type="GDScript" id="GDScript_qxadb"]
script/source = "extends CharacterBody2D

@export var gravity = 100
@export var jump_velocity = 400
@export var speed = 120
@export var crouch_speed = 80
@export var sprint_speed = 180
var start_y

func _ready():
	print(position.y)

func _physics_process(delta):
	# Add the gravity.
	if not is_on_floor() and position.y != start_y:
		velocity.y += gravity * delta
	else:
		velocity.y = 0 
	
	if Input.is_action_pressed(\"ForwardD\") or Input.is_action_pressed(\"ForwardArrow\"):
		if Input.is_action_pressed(\"Crouch\"):
			velocity.x = crouch_speed
		elif Input.is_action_pressed(\"Sprint\"):
			velocity.x = sprint_speed
		else:
			velocity.x = speed
			
	elif Input.is_action_pressed(\"BackwardA\") or Input.is_action_pressed(\"BackwardArrow\"):
		if Input.is_action_pressed(\"Crouch\"):
			velocity.x = -crouch_speed
		elif Input.is_action_pressed(\"Sprint\"):
			velocity.x = -sprint_speed
		else:
			velocity.x = -speed
	else:
		velocity.x = 0
	
		# Handle Jump.
	if Input.is_action_just_pressed(\"JumpW\") and not is_on_floor() or Input.is_action_just_pressed(\"JumpArrow\") and not is_on_floor():
		velocity.y = -jump_velocity

	if velocity.length() > 0:
		if not Input.is_action_pressed(\"Crouch\") and Input.is_action_pressed(\"Sprint\"):
			velocity = velocity.normalized() * sprint_speed
			$movement.animation = \"run\"
			$movement.play()
		elif Input.is_action_pressed(\"Crouch\"):
			velocity = velocity.normalized() * crouch_speed
			$movement.animation = \"crouch\"
			$movement.play()
		else:
			velocity = velocity.normalized() * speed
			$movement.animation = \"walk-good\"
			$movement.play()
	else: 
		# Reset to default animation
		$movement.animation = \"walk-good\"
		$movement.play()
		$movement.stop()
	
	if velocity.x < 0: 
		$movement.flip_h = true
	if velocity.x > 0:
		$movement.flip_h = false
		
	position += velocity * delta

	
"

[sub_resource type="SpriteFrames" id="SpriteFrames_enjib"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("1_y2jd1")
}, {
"duration": 1.0,
"texture": ExtResource("2_ujgvs")
}, {
"duration": 1.0,
"texture": ExtResource("3_mf6a4")
}, {
"duration": 1.0,
"texture": ExtResource("4_ia4ch")
}],
"loop": true,
"name": &"crouch",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("5_ysutu")
}, {
"duration": 1.0,
"texture": ExtResource("6_yyu65")
}, {
"duration": 1.0,
"texture": ExtResource("7_pi856")
}, {
"duration": 1.0,
"texture": ExtResource("8_jbhoh")
}],
"loop": true,
"name": &"run",
"speed": 8.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("9_rav1o")
}, {
"duration": 1.0,
"texture": ExtResource("10_7nqqg")
}, {
"duration": 1.0,
"texture": ExtResource("11_mwboh")
}, {
"duration": 1.0,
"texture": ExtResource("12_rtvn4")
}, {
"duration": 1.0,
"texture": ExtResource("13_bql0y")
}, {
"duration": 1.0,
"texture": ExtResource("14_lb3sg")
}, {
"duration": 1.0,
"texture": ExtResource("15_wwkyk")
}, {
"duration": 1.0,
"texture": ExtResource("16_6txg6")
}],
"loop": true,
"name": &"walk-good",
"speed": 8.0
}]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_njkbu"]
size = Vector2(106, 182)

[node name="main_character" type="CharacterBody2D"]
position = Vector2(1, -2)
script = SubResource("GDScript_qxadb")
metadata/_edit_group_ = true

[node name="movement" type="AnimatedSprite2D" parent="."]
z_index = 2
position = Vector2(147, 595)
scale = Vector2(0.7, 0.7)
sprite_frames = SubResource("SpriteFrames_enjib")
animation = &"walk-good"

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(130, 595)
shape = SubResource("RectangleShape2D_njkbu")

[node name="StartPosition" type="Marker2D" parent="."]
position = Vector2(13, 50)
